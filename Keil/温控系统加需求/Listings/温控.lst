C51 COMPILER V9.59.0.0   ____                                                              12/28/2022 11:20:02 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE ____
OBJECT MODULE PLACED IN .\Objects\ÎÂ¿Ø.obj
COMPILER INVOKED BY: E:\Keil\C51\BIN\C51.EXE ÎÂ¿Ø.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\ÎÂ¿Ø.ls
                    -t) TABS(2) OBJECT(.\Objects\ÎÂ¿Ø.obj)

line level    source

   1          #include <reg51.h>
   2          #include <intrins.h>
   3          #include <LCD12864.h>
   4          #include <ds1302.h>
   5          
   6          #include <word.h>
   7          #include <18b20.h>
   8          #include <delay.h>
   9          #include <key.h>
  10            
  11          uchar time_data[6]={20,13,17,11,21,14};
  12          
  13          sbit relay_jiare=P1^0;  // åŠ çƒ­åˆ¶å†·ä¸èœ‚é¸£å™¨å¼•è„šå®šä¹‰
  14          sbit relay_zhileng=P1^1;
  15          sbit buzzer=P1^4;
  16          
  17          uint setL = 25;     // è®¾ç½®æ¸©åº¦ä¸‹é™
  18          uint setH = 30;     // è®¾ç½®æ¸©åº¦ä¸Šé™
  19          uchar DisFlag = 0;  // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—
  20          uchar SetFlag = 0;  // è®¾ç½®å‚æ•°æ ‡å¿—
  21          uchar pageFlag = 0; // è®¾ç½®
  22          
  23          uchar i = 0;  // åˆ‡æ¢é¡µé¢æ¸…å±
  24          uchar j = 0;
  25          uchar z = 0;
  26          
  27          uint time2ms=0;   // å®šæ—¶è®¡æ•°
  28          uint buzLater=0;  // èœ‚é¸£å™¨ç´¯åŠ æ£€æµ‹
  29          
  30          uint temp1;               // è¯»å–æ¸©åº¦åˆå§‹å€¼
  31          float temperature = 0;        // å®é™…æ¸©åº¦å€¼
  32          uint temp = 0;  // å­˜æ”¾è®¡ç®—æ¸©åº¦å€¼
  33          uchar read_temp_flag = 1;     // å®šä¹‰è¯»æ¸©åº¦æ ‡å¿—
  34          
  35          void temp_show();   // æ¸©æ§éƒ¨åˆ†
  36          void check_key();   // æŒ‰é”®æ£€æŸ¥
  37          void init_timer0();   // å®šæ—¶å™¨åˆå§‹åŒ–
  38          
  39          void show_ds1302(uchar *time)
  40          {
  41   1        show_num(1,0,8,num+16*2);//2
  42   1        show_num(1,0,16,num+16*0);//0
  43   1        show_num(1,0,24,num+16*(time[0]/10));//å¹´ åä½
  44   1        show_num(1,0,32,num+16*(time[0]%10));//å¹´ ä¸ªä½
  45   1        
  46   1        show_num(1,0,56,num+16*(time[1]/10));//æœˆ åä½
  47   1        show_num(2,0,0,num+16*(time[1]%10));//æœˆ ä¸ªä½
  48   1        
  49   1        show_num(2,0,24,num+16*(time[2]/10));//æ—¥ åä½
  50   1        show_num(2,0,32,num+16*(time[2]%10));//æ—¥ ä¸ªä½
  51   1        
  52   1        show_num(1,2,32,num+16*(time[3]/10));//æ—¶ åä½
  53   1        show_num(1,2,40,num+16*(time[3]%10));//æ—¶ ä¸ªä½
  54   1        
C51 COMPILER V9.59.0.0   ____                                                              12/28/2022 11:20:02 PAGE 2   

  55   1        show_num(1,2,56,num+16*(time[4]/10));//åˆ† åä½
  56   1        show_num(2,2,0,num+16*(time[4]%10));//åˆ† ä¸ªä½
  57   1        
  58   1        show_num(2,2,16,num+16*(time[5]/10));//ç§’ åä½
  59   1        show_num(2,2,24,num+16*(time[5]%10));//ç§’ ä¸ªä½
  60   1      }
  61          
  62          void init_words()
  63          {
  64   1        show_ch(1,0,40,ch1+32*0); // å¹´
  65   1        show_ch(2,0,8,ch1+32*1); // æœˆ
  66   1        show_ch(2,0,40,ch1+32*2); // æ—¥
  67   1        show_num(1,2,48,num+16*14); // ï¼š
  68   1        show_num(2,2,8,num+16*14); // ï¼š
  69   1        show_ch(1,4,0,ch1+32*4); // å½“
  70   1        show_ch(1,4,16,ch1+32*5); // å‰
  71   1        show_num(1,4,56,num+16*11); // .
  72   1        show_ch(2,4,8,ch1+32*3); // â„ƒ
  73   1        show_ch(1,6,40,ch1+32*3); // â„ƒ
  74   1        show_ch(2,6,40,ch1+32*3); // â„ƒ
  75   1      //  show_im(1,2,0*16,image1);
  76   1      }
  77          
  78          void init_welcom()
  79          {
  80   1        show_im(1,2,0,image1+128*1);
  81   1        show_im(1,2,32,image1+128*2);
  82   1        show_im(2,2,0,image1+128*3);
  83   1        show_im(2,2,32,image1+128*4);
  84   1      }
  85          
  86          void init_name()
  87          {
  88   1        show_ch(1,1,24,ch1+32*17); // æœºç”µ1903ç­
  89   1        show_ch(1,1,40,ch1+32*18);
  90   1        show_num(1,1,56,num+16*1);
  91   1        show_num(2,1,0,num+16*9);
  92   1        show_num(2,1,8,num+16*0);
  93   1        show_num(2,1,16,num+16*3);
  94   1        show_ch(2,1,24,ch1+32*19);
  95   1        show_ch(1,3,40,ch1+32*11); // ç‹ä¸€åš
  96   1        show_num(1,3,56,num+16*16);
  97   1        show_num(2,3,0,num+16*16);
  98   1        show_ch(2,3,8,ch1+32*13);
  99   1        show_num(1,5,16,num+16*1); // 19405010322
 100   1        show_num(1,5,24,num+16*9);
 101   1        show_num(1,5,32,num+16*4);
 102   1        show_num(1,5,40,num+16*0);
 103   1        show_num(1,5,48,num+16*5);
 104   1        show_num(1,5,56,num+16*0);
 105   1        show_num(2,5,0,num+16*1);
 106   1        show_num(2,5,8,num+16*0);
 107   1        show_num(2,5,16,num+16*3);
 108   1        show_num(2,5,24,num+16*2);
 109   1        show_num(2,5,32,num+16*2);
 110   1      }
 111          
 112          void main()
 113          {
 114   1        init_timer0();
 115   1        InitLCD();
 116   1        ClearScreen(0);
C51 COMPILER V9.59.0.0   ____                                                              12/28/2022 11:20:02 PAGE 3   

 117   1        Set_line(0);
 118   1      
 119   1        while(1)
 120   1        {
 121   2          temp_show();
 122   2        }
 123   1      }
 124          
 125          void temp_show()
 126          {
 127   1      
 128   1        page_key();
 129   1        if(pageFlag == 1)
 130   1        {
 131   2          if(i == 0)
 132   2          {
 133   3            ClearScreen(0);
 134   3            i = 1;
 135   3          }
 136   2          init_welcom();    
 137   2        }
 138   1        if(pageFlag == 2)
 139   1        {
 140   2          if(z == 0)
 141   2          {
 142   3            ClearScreen(0);
 143   3            z = 1;
 144   3          }
 145   2          init_words();
 146   2          check_key();
 147   2          DS1302_Readtime();
 148   2          show_ds1302(time_data);
 149   2          if(read_temp_flag == 1)
 150   2          {
 151   3            read_temp_flag = 0;
 152   3            temp1 = read_temperature();           // è¯»å–æ¸©åº¦
 153   3            temperature = (float)temp1*0.0625;    // å®é™…æ¸©åº¦å€¼
 154   3            temp = (int)temperature * 10;             // è®¡ç®—æ¸©åº¦å€¼
 155   3          }
 156   2          if(DisFlag == 1)
 157   2          {
 158   3            DisFlag=0;
 159   3            if((temperature>0)&&(temperature<150))
 160   3            {
 161   4              show_num(1,4,32,num+16*15);                 // +
 162   4              show_num(1,4,40,num+16*(temp/100));         // æ¸©åº¦ç¬¬ä¸€ä½
 163   4              show_num(1,4,48,num+16*(temp%100/10));      // æ¸©åº¦ç¬¬äºŒä½
 164   4              show_num(2,4,0,num+16*(temp%10));           // æ¸©åº¦ç¬¬ä¸‰ä½
 165   4        
 166   4              if(temperature<setL)        // æ¸©åº¦è¿‡ä½
 167   4              {
 168   5                  relay_jiare=0;    // å¼€å¯å‡æ¸© å…³é—­é™æ¸©
 169   5                  relay_zhileng=1;
 170   5                  show_ch(2,4,32,ch1+32*8);   // è¿‡
 171   5                  show_ch(2,4,48,ch1+32*10);  // å†·
 172   5              }else if(temperature>setH)  // æ¸©åº¦è¿‡é«˜
 173   4              {
 174   5                  relay_jiare=1;    // å…³é—­å‡æ¸© å¼€å¯é™æ¸©
 175   5                  relay_zhileng=0;
 176   5                  show_ch(2,4,32,ch1+32*8);   // è¿‡
 177   5                  show_ch(2,4,48,ch1+32*9);  // çƒ­
 178   5              }else{
C51 COMPILER V9.59.0.0   ____                                                              12/28/2022 11:20:02 PAGE 4   

 179   5                  relay_jiare=1;    // å…³é—­å‡æ¸© å…³é—­é™æ¸©
 180   5                  relay_zhileng=1;
 181   5                  buzLater=0;       // æ­£å¸¸æƒ…å†µ
 182   5                  show_ch(2,4,32,ch1+32*6);       // æ­£
 183   5                  show_ch(2,4,48,ch1+32*7);       // å¸¸
 184   5              }
 185   4              if(buzLater>=2)       // è‹¥éæ­£å¸¸æ¸…é›¶ è¿‡é«˜è¿‡ä½ç´¯åŠ  è¶…è¿‡2ç§’å³
 186   4              {
 187   5                buzzer=0;           // æ‰“å¼€èœ‚é¸£å™¨
 188   5                delay_ms(1000);       
 189   5              }else{        
 190   5                buzzer=1;           // å…³é—­èœ‚é¸£å™¨
 191   5              } 
 192   4            }
 193   3      /******************æ˜¾ç¤ºæ¸©åº¦ä¸Šä¸‹é™å€¼***********************/
 194   3            show_num(1,6,16,num+16*15);                 // ä¸‹é™ +
 195   3            show_num(1,6,24,num+16*(setL/10));          // æ¸©åº¦ç¬¬ä¸€ä½
 196   3            show_num(1,6,32,num+16*(setL%10));          // æ¸©åº¦ç¬¬äºŒä½
 197   3            show_num(2,6,16,num+16*15);                 // ä¸Šé™ +
 198   3            show_num(2,6,24,num+16*(setH/10));          // æ¸©åº¦ç¬¬ä¸€ä½
 199   3            show_num(2,6,32,num+16*(setH%10));          // æ¸©åº¦ç¬¬äºŒä½
 200   3      
 201   3            if(SetFlag == 0)        // æŸ¥è¯¢æŒ‰é”®è®¾ç½®æ ‡å¿—
 202   3            {
 203   4              show_ch(1,6,0,ch1+32*15); // â†“
 204   4              show_ch(2,6,0,ch1+32*14); // â†‘ æ›´æ–°æ˜¾ç¤ºæ ‡å¿—
 205   4            }else if(SetFlag == 1)                // æŒ‰é”®è®¾ç½®æ ‡å¿—
 206   3              {
 207   4                show_ch(1,6,0,ch1+32*15);         // â†“
 208   4                delay_ms(500);
 209   4                show_ch(1,6,0,ch1+32*16);         // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—(é—ªçƒ)
 210   4              }else if(SetFlag == 2)              // æŸ¥è¯¢æŒ‰é”®è®¾ç½®æ ‡å¿—
 211   3              {
 212   4                show_ch(2,6,0,ch1+32*14);         // â†‘
 213   4                delay_ms(500);
 214   4                show_ch(2,6,0,ch1+32*16);         // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—(é—ªçƒ)
 215   4              }
 216   3              j = 0;
 217   3            } 
 218   2        }
 219   1        if(pageFlag == 3)
 220   1        {
 221   2          if(j == 0)
 222   2          {
 223   3            ClearScreen(0);
 224   3            j = 1;
 225   3          }
 226   2          init_name();
 227   2          z = 0;
 228   2        }
 229   1      }
 230          void init_timer0()
 231          {
 232   1        TMOD = 0x61;
 233   1        TH0 = (65536-20000)/256;   // ä¸ºå®šæ—¶å™¨èµ‹åˆå€¼20ms
 234   1        TL0 = (65536-20000)%256;
 235   1        TR0 = 1;  // å®šæ—¶å™¨å¼€å…³æ‰“å¼€
 236   1        ET0 = 1;  // å®šæ—¶å™¨ä¸­æ–­æ‰“å¼€
 237   1        EA = 1;   // æ€»ä¸­æ–­æ‰“å¼€
 238   1      }
 239          
 240          /*    å®šæ—¶å™¨ä¸­æ–­ç¨‹åº   */
C51 COMPILER V9.59.0.0   ____                                                              12/28/2022 11:20:02 PAGE 5   

 241          void timer0() interrupt 1
 242          {
 243   1        TH0 = (65536-20000)/256;   // ä¸ºå®šæ—¶å™¨èµ‹åˆå€¼20ms
 244   1        TL0 = (65536-20000)%256;
 245   1        time2ms++;
 246   1        
 247   1        if(time2ms % 10 == 0)   // æ¯200æ¯«ç§’è¿›è¡Œæ˜¾ç¤ºåˆ·æ–°
 248   1        {
 249   2          DisFlag=1;
 250   2          if(time2ms%50==0)     // æ¯1000æ¯«ç§’è¿›è¡Œè¯»æ¸©åº¦åˆ·æ–°
 251   2          {
 252   3            read_temp_flag=1; //è¯»æ ‡å¿—ä½ç½®1  
 253   3          if(buzLater<200)  buzLater++;
 254   3          }
 255   2        }
 256   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2271    ----
   CONSTANT SIZE    =   1552    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     29       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
