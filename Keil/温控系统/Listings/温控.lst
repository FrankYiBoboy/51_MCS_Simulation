C51 COMPILER V9.59.0.0   ____                                                              06/20/2022 09:05:45 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE ____
OBJECT MODULE PLACED IN .\Objects\ÎÂ¿Ø.obj
COMPILER INVOKED BY: E:\keli\C51\BIN\C51.EXE ÎÂ¿Ø.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\ÎÂ¿Ø.ls
                    -t) TABS(2) OBJECT(.\Objects\ÎÂ¿Ø.obj)

line level    source

   1          #include <reg51.h>
   2          #include <18b20.h>
   3          #include <delay.h>
   4          #include <lcd1602.h>
   5          #include <stdio.h>
   6          
   7          
   8          #define uchar unsigned char
   9          #define uint unsigned int
  10            
  11          sbit key1=P2^0;  // æŒ‰é”®å¼•è„šå®šä¹‰
  12          sbit key2=P2^1;
  13          sbit key3=P2^2;
  14          
  15          sbit relay_jiare=P1^0;  // åŠ çƒ­åˆ¶å†·ä¸èœ‚é¸£å™¨å¼•è„šå®šä¹‰
  16          sbit relay_zhileng=P1^1;
  17          sbit buzzer=P1^4;
  18          
  19          uint setL = 25;     // è®¾ç½®æ¸©åº¦ä¸‹é™
  20          uint setH = 30;     // è®¾ç½®æ¸©åº¦ä¸Šé™
  21          uchar DisFlag = 0;  // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—
  22          uchar SetFlag = 0;  // è®¾ç½®å‚æ•°æ ‡å¿—
  23          
  24          uint time2ms=0;   // å®šæ—¶è®¡æ•°
  25          uint buzLater=0;  // èœ‚é¸£å™¨ç´¯åŠ æ£€æµ‹
  26          
  27          uint temp1;               // è¯»å–æ¸©åº¦åˆå§‹å€¼
  28          float temperature = 0;        // å®é™…æ¸©åº¦å€¼
  29          uchar read_temp_flag = 1;     // å®šä¹‰è¯»æ¸©åº¦æ ‡å¿—
  30          
  31          char dis0[16];      //å®šä¹‰æ˜¾ç¤ºåŒºåŸŸä¸´æ—¶å­˜å‚¨æ•°ç»„
  32          char dis1[16];      //å®šä¹‰æ˜¾ç¤ºåŒºåŸŸä¸´æ—¶å­˜å‚¨æ•°ç»„
  33          
  34          void check_key();   // æŒ‰é”®æ£€æŸ¥
  35          void init_timer0();   // å®šæ—¶å™¨åˆå§‹åŒ–
  36          void dig_show();    // æ˜¾ç¤º
  37          
  38          //uchar Num = 0;      // è®¡æ•°
  39          
  40          void main()
  41          {
  42   1        relay_jiare = 1;
  43   1        relay_zhileng = 1;
  44   1        buzzer = 1;
  45   1        
  46   1        init_timer0();    // åˆå§‹åŒ–å®šæ—¶å™¨
  47   1        LCD_init();       // åˆå§‹åŒ–LCD
  48   1        delay_ms(100);
  49   1        LCD_Clear();
  50   1          
  51   1        while(1)
  52   1        {
  53   2          dig_show();
  54   2        }
C51 COMPILER V9.59.0.0   ____                                                              06/20/2022 09:05:45 PAGE 2   

  55   1      }
  56          
  57          void dig_show()
  58          {
  59   1        check_key();
  60   1        if(read_temp_flag == 1)
  61   1        {
  62   2          read_temp_flag = 0;
  63   2          temp1 = read_temperature();           // è¯»å–æ¸©åº¦
  64   2          temperature = (float)temp1*0.0625;    // å®é™…æ¸©åº¦å€¼
  65   2        }
  66   1        if(DisFlag == 1)
  67   1        {
  68   2          DisFlag=0;
  69   2          if((temperature>0)&&(temperature<150))
  70   2          {
  71   3            sprintf(dis0,"Temp:%4.1f C",temperature);     // å°†æ¸©åº¦å€¼å­˜å‚¨è¿›æš‚å­˜æ˜¾ç¤ºæ•°ç»„
  72   3            LCD_Write_String(0,0,dis0);                   // æ˜¾ç¤ºç¬¬ä¸€è¡Œç¬¬ä¸€ä½
  73   3            LCD_Write_Char(9,0,0xdf);                     // æ˜¾ç¤ºæ¸©åº¦å·¦ä¸Šè§’Â°
  74   3            
  75   3            if(temperature<setL)        // æ¸©åº¦è¿‡ä½
  76   3            {
  77   4                relay_jiare=0;    // å¼€å¯å‡æ¸© å…³é—­é™æ¸©
  78   4                relay_zhileng=1;  
  79   4            }else if(temperature>setH)  // æ¸©åº¦è¿‡é«˜
  80   3            {
  81   4                relay_jiare=1;    // å…³é—­å‡æ¸© å¼€å¯é™æ¸©
  82   4                relay_zhileng=0;
  83   4            }else{
  84   4                relay_jiare=1;    // å…³é—­å‡æ¸© å…³é—­é™æ¸©
  85   4                relay_zhileng=1;
  86   4                buzLater=0;       // æ­£å¸¸æƒ…å†µ
  87   4            }
  88   3            if(buzLater>=2)       // è‹¥éæ­£å¸¸æ¸…é›¶ è¿‡é«˜è¿‡ä½ç´¯åŠ  è¶…è¿‡2ç§’å³
  89   3            {
  90   4              buzzer=0;           // æ‰“å¼€èœ‚é¸£å™¨
  91   4              delay_ms(1000);       
  92   4            }else{        
  93   4              buzzer=1;           // å…³é—­èœ‚é¸£å™¨
  94   4            } 
  95   3          }
  96   2          
  97   2          sprintf(dis1," %02d-- %02d       ",setL,setH);    // å°†æ¸©åº¦èŒƒå›´å­˜å‚¨æš‚å®šæ˜¾ç¤ºæ•°ç»„
  98   2          LCD_Write_String(0,1,dis1);       // åˆå§‹åŒ–æ˜¾ç¤º    
  99   2          if(SetFlag == 0)      // æŸ¥è¯¢æŒ‰é”®è®¾ç½®æ ‡å¿—
 100   2          {
 101   3            LCD_Write_Char(0,1,' ');
 102   3            LCD_Write_Char(5,1,' ');      // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—
 103   3          }else if(SetFlag == 1)//æŒ‰é”®è®¾ç½®æ ‡å¿—
 104   2            {
 105   3              LCD_Write_Char(0,1,'W');
 106   3              LCD_Write_Char(5,1,' ');    // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—(é—ªçƒ)
 107   3            }else if(SetFlag == 2)  // æŸ¥è¯¢æŒ‰é”®è®¾ç½®æ ‡å¿—
 108   2            {
 109   3              LCD_Write_Char(0,1,' ');
 110   3              LCD_Write_Char(5,1,'W');    // æ›´æ–°æ˜¾ç¤ºæ ‡å¿—
 111   3            } 
 112   2        } 
 113   1      }
 114          
 115          void check_key()
 116          {
C51 COMPILER V9.59.0.0   ____                                                              06/20/2022 09:05:45 PAGE 3   

 117   1        uchar rekey = 0;
 118   1        if((key1==0)||(key2==0)||(key3==0))
 119   1        {
 120   2          delay_ms(10);
 121   2          if(rekey==0)  
 122   2          {
 123   3            if(key1==0)    // æ£€æµ‹æŒ‰é”®1æ˜¯å¦æŒ‰ä¸‹
 124   3            {
 125   4              rekey=1;
 126   4              SetFlag++;  // è®¾ç½®å‚æ•°æ ‡å¿—
 127   4              if(SetFlag >= 3) SetFlag = 0;     // è®¾ç½®1,è®¾ç½®2
 128   4            } 
 129   3            else if(key2 == 0)  //   æ£€æµ‹æŒ‰é”®2æ˜¯å¦æŒ‰ä¸‹
 130   3            {
 131   4              rekey=1;
 132   4              if(SetFlag == 1)          // å¤„äºè®¾ç½®1
 133   4              {
 134   5                if(setL > 0 )
 135   5                  {
 136   6                  setL = setL-1;
 137   6                  }
 138   5              }
 139   4              else if(SetFlag == 2)     // å¤„äºè®¾ç½®2
 140   4              {
 141   5                if(setH > 0)
 142   5                {
 143   6                setH = setH-1;
 144   6                }
 145   5              }           
 146   4            }else if(key3==0)     // æ£€æµ‹æŒ‰é”®3æ˜¯å¦æŒ‰ä¸‹
 147   3            {
 148   4              rekey=1;
 149   4              if(SetFlag == 1)      // å¤„äºè®¾ç½®1
 150   4              {
 151   5                if(setL < 99 )
 152   5                {
 153   6                setL=setL+1;
 154   6                }
 155   5              }
 156   4              else if(SetFlag==2) // å¤„äºè®¾ç½®2
 157   4              {
 158   5                if(setH < 99 )
 159   5                {
 160   6                setH=setH+1;
 161   6                }
 162   5              }       
 163   4            }
 164   3          }
 165   2        }else{
 166   2          rekey = 0;  // é˜²æ­¢é‡æ–°æ£€æµ‹åˆ°æŒ‰é”®
 167   2        }
 168   1      }
 169          
 170          void init_timer0()
 171          {
 172   1        TMOD = 0x61;
 173   1        TH0 = (65536-20000)/256;   // ä¸ºå®šæ—¶å™¨èµ‹åˆå€¼20ms
 174   1        TL0 = (65536-20000)%256;
 175   1        TR0 = 1;  // å®šæ—¶å™¨å¼€å…³æ‰“å¼€
 176   1        ET0 = 1;  // å®šæ—¶å™¨ä¸­æ–­æ‰“å¼€
 177   1        EA = 1;   // æ€»ä¸­æ–­æ‰“å¼€
 178   1      }
C51 COMPILER V9.59.0.0   ____                                                              06/20/2022 09:05:45 PAGE 4   

 179          
 180          /*    å®šæ—¶å™¨ä¸­æ–­ç¨‹åº   */
 181          void timer0() interrupt 1
 182          {
 183   1        TH0 = (65536-20000)/256;   // ä¸ºå®šæ—¶å™¨èµ‹åˆå€¼20ms
 184   1        TL0 = (65536-20000)%256;
 185   1        time2ms++;
 186   1        
 187   1        if(time2ms % 10 == 0)   // æ¯200æ¯«ç§’è¿›è¡Œæ˜¾ç¤ºåˆ·æ–°
 188   1        {
 189   2          DisFlag=1;
 190   2          if(time2ms%50==0)     // æ¯1000æ¯«ç§’è¿›è¡Œè¯»æ¸©åº¦åˆ·æ–°
 191   2          {
 192   3            read_temp_flag=1; //è¯»æ ‡å¿—ä½ç½®1  
 193   3          if(buzLater<200)  buzLater++;
 194   3          }
 195   2        }
 196   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    654    ----
   CONSTANT SIZE    =     33    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     49       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
